#include theme
#include "dbconnection"
MAP

FONTSET "fonts.lst"
IMAGETYPE png
MAXSIZE 4000
SIZE 800 800
EXTENT 47586 1621243 1197769 2679357
EXTENT 16805492 -4049385 16857351 -3975830
UNITS OSM_UNITS 
IMAGECOLOR _water_clr
WEB
    METADATA
      "ows_enable_request"   "*"
       wms_srs OSM_WMS_SRS 
        labelcache_map_edge_buffer "-10"
        wms_title "osm france"
    END
END

#define _debug 10

DEBUG _debug
#if _debug > 0 || _layerdebug > 0
CONFIG "MS_ERRORFILE" "stderr"
#endif

CONFIG "PROJ_LIB" _proj_lib
PROJECTION
##900913
##"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
##"init=epsg:27572"
##"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"
##"init=epsg:OSM_SRID"
"init=epsg:OSM_SRID"
END

LAYER
    TYPE POLYGON
    STATUS ON
    GROUP "default"
DEBUG _layerdebug
    NAME "land"
    PROJECTION
        "init=epsg:4326"
    END
    MINSCALEDENOM 100000000
    DATA "data/TM_WORLD_BORDERS-0.3.shp"
    CLASS
        STYLE
            COLOR _bg_clr
        END
    END
END

LAYER
    TYPE POLYGON
    STATUS ON
    GROUP "default"
    NAME "land"
DEBUG _layerdebug
    PROJECTION
        "init=epsg:900913"
    END
    MAXSCALEDENOM 100000000
    MINSCALEDENOM 5000000
    DATA "data/shoreline_300"
    CLASS
        STYLE
            COLOR _bg_clr
        END
    END
END

LAYER
    TYPE POLYGON
    STATUS ON
    GROUP "default"
    NAME "land"
    PROJECTION
        "init=epsg:900913"
    END
    MAXSCALEDENOM 5000000
    DATA "data/processed_p"
DEBUG _layerdebug
    CLASS
        STYLE
            COLOR _bg_clr
        END
    END
END

#include "landuse.map"

LAYER
   TYPE LINE
   STATUS ON
   GROUP "default"
   NAME "borders"
   DATA "data/10m_admin_0_boundary_lines_land"
DEBUG _layerdebug
    CLASS
   MINSCALEDENOM 10000000
        STYLE
            WIDTH 0.5
            COLOR _border_clr
        END
    END
    CLASS
        STYLE
            WIDTH 5
            OPACITY 50
            COLOR _border_clr
        END
        STYLE
            WIDTH 1
            pattern 6 6 2 6 end
            COLOR _border_close_clr
        END
    END
END

SYMBOL
    NAME "rail"
    TYPE TRUETYPE
    FONT sc
    CHARACTER '|'
END




#include "highways_5k.map"
#include "highways_10k.map"
#include "highways_25k.map"
#include "highways_50k.map"
#include "highways_100k.map"
#include "highways_250k.map"
#include "highways_500k.map"
#include "highways_1m.map"
#include "highways_2.5m.map"
#include "highways_5m.map"
#include "highways_10m.map"


##include "buildings.map"



SYMBOL
    NAME "citycircle"
    TYPE ELLIPSE
    POINTS  1 1 END
    FILLED TRUE
END


SYMBOL
 NAME "oneway"
 TYPE TRUETYPE
 FONT scb
 CHARACTER "&#8594;"
END

LAYER
    TYPE LINE
    STATUS ON
    PROJECTION
        "init=epsg:OSM_SRID"
    END
    GROUP "defaultoff"
    NAME "oneways"
    CONNECTIONTYPE postgis
    CONNECTION _db_connection
    DATA "way from (select way, osm_id from osm_line where oneway='yes' and (highway ~ 'link' or highway in ('residential','tertiary','secondary','primary','service')) order by z_order) as foo using unique osm_id using srid=OSM_SRID"
    PROCESSING "CLOSE_CONNECTION=DEFER"
    MAXSCALEDENOM 10010
    CLASS
        STYLE
            SYMBOL "oneway"
            GAP -150
            SIZE 11
            COLOR _oneway_clr
        END
    END
END

#include "places_25k.map"
#include "places_50k.map"
#include "places_100k.map"
#include "places_250k.map"
#include "places_500k.map"
#include "places_1m.map"
#include "places_2.5m.map"
#include "places_5m.map"
#include "places_10m.map"
#include "places_25m.map"
#include "places_50m.map"

LAYER
   TYPE LINE
   STATUS ON
   GROUP "defaultoff"
   NAME "admin_bnd"
    STATUS ON
    PROJECTION
        "init=epsg:OSM_SRID"
    END
    CONNECTIONTYPE postgis
    CONNECTION _db_connection
    DATA "geometry from (select geometry, osm_id, name from osm_new_admin) as foo using unique osm_id using srid=OSM_SRID"
    PROCESSING "CLOSE_CONNECTION=DEFER"
    LABELITEM "name"
DEBUG _layerdebug
    CLASS
        STYLE
            WIDTH 0.5
            COLOR 255 0 0
        END
        LABEL
         SIZE small
         COLOR 255 0 0
        END
    END
END

END
